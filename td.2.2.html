<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Tower Defense</title>

<style>
body{
margin:0;
display:flex;
background:#000;
color:white;
font-family:Arial;
}

#game{cursor:crosshair}

#sidebar{
width:180px;
background:#111;
padding:10px;
}

.towerBtn{
width:130px;
height:130px;
margin:10px auto;
border:2px solid #444;
border-radius:12px;
cursor:pointer;
overflow:hidden;
}

.towerBtn img{
width:100%;
height:100%;
object-fit:cover;
}

.active{border-color:#00ff88}

.themeBtn{
margin:8px 0;
padding:6px;
background:#333;
text-align:center;
border-radius:8px;
cursor:pointer;
}
</style>
</head>

<body>

<canvas id="game" width="900" height="500"></canvas>

<div id="sidebar">

<div class="towerBtn active" data-type="fire"><img src="fire.png"></div>
<div class="towerBtn" data-type="ice"><img src="ice.png"></div>
<div class="towerBtn" data-type="sniper"><img src="sniper.png"></div>

<div class="themeBtn" onclick="setTheme('desert')">üåµ W√ºste</div>
<div class="themeBtn" onclick="setTheme('ice')">‚ùÑ Eis</div>
<div class="themeBtn" onclick="setTheme('lava')">üåã Lava</div>

</div>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");

let towers=[];
let enemies=[];
let projectiles=[];
let selectedTower="fire";

let theme="desert";

const themes={
desert:"#c2b280",
ice:"#88ccff",
lava:"#662222"
};

function setTheme(t){theme=t;}

document.querySelectorAll(".towerBtn").forEach(btn=>{
btn.onclick=()=>{
document.querySelectorAll(".towerBtn").forEach(b=>b.classList.remove("active"));
btn.classList.add("active");
selectedTower=btn.dataset.type;
};
});

canvas.onclick=e=>{
let r=canvas.getBoundingClientRect();
let x=e.clientX-r.left;
let y=e.clientY-r.top;
towers.push(makeTower(x,y,selectedTower));
};

function makeTower(x,y,type){
return{
x,y,type,
range:type=="sniper"?240:130,
damage:type=="fire"?6:type=="ice"?3:14,
rate:type=="sniper"?90:45,
cd:0
};
}

function spawnEnemy(type){
enemies.push({
x:0,
y:250+Math.random()*80-40,
hp:type=="boss"?600:type=="tank"?250:type=="fly"?90:70,
speed:type=="fast"?2.3:type=="tank"?0.7:1.3,
type,
slow:0
});
}

setInterval(()=>{
let r=Math.random();
if(r<.45)spawnEnemy("fast");
else if(r<.7)spawnEnemy("tank");
else if(r<.9)spawnEnemy("fly");
else spawnEnemy("boss");
},1400);

function shoot(t,e){
projectiles.push({
x:t.x,
y:t.y,
tx:e,
speed:6,
type:t.type,
damage:t.damage
});
}

function update(){

ctx.fillStyle=themes[theme];
ctx.fillRect(0,0,900,500);

enemies.forEach(e=>{
let s=e.speed*(e.slow>0?0.4:1);
e.x+=s;
if(e.slow>0)e.slow--;

ctx.fillStyle=
e.type=="boss"?"purple":
e.type=="fly"?"cyan":"red";

ctx.beginPath();
ctx.arc(e.x,e.y,12,0,Math.PI*2);
ctx.fill();

ctx.fillStyle="lime";
ctx.fillRect(e.x-15,e.y-18,(e.hp/600)*30,4);
});

enemies=enemies.filter(e=>e.x<900&&e.hp>0);

towers.forEach(t=>{
ctx.fillStyle=
t.type=="fire"?"orange":
t.type=="ice"?"lightblue":"yellow";

ctx.beginPath();
ctx.arc(t.x,t.y,14,0,Math.PI*2);
ctx.fill();

if(t.cd>0){t.cd--;return;}

let target=enemies.find(e=>Math.hypot(e.x-t.x,e.y-t.y)<t.range);

if(target){
t.cd=t.rate;
shoot(t,target);
}
});

projectiles.forEach(p=>{
let dx=p.tx.x-p.x;
let dy=p.tx.y-p.y;
let d=Math.hypot(dx,dy);

p.x+=dx/d*p.speed;
p.y+=dy/d*p.speed;

ctx.fillStyle="white";
ctx.beginPath();
ctx.arc(p.x,p.y,3,0,Math.PI*2);
ctx.fill();

if(d<8){
hit(p);
p.dead=true;
}
});

projectiles=projectiles.filter(p=>!p.dead);

requestAnimationFrame(update);
}

function hit(p){

if(p.type=="fire"){
enemies.forEach(e=>{
if(Math.hypot(e.x-p.x,e.y-p.y)<40){
e.hp-=p.damage;
}
});
explosion(p.x,p.y);
}

else if(p.type=="ice"){
p.tx.hp-=p.damage;
p.tx.slow=70;
}

else{
p.tx.hp-=p.damage;
}

}

function explosion(x,y){
ctx.fillStyle="rgba(255,120,0,0.6)";
ctx.beginPath();
ctx.arc(x,y,45,0,Math.PI*2);
ctx.fill();
}

update();
</script>
</body>
</html>
